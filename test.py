import streamlit as st
import pandas as pd

# =====================
# μ•½ λ°μ΄ν„° μ •μ (DB λ€μ²΄μ©)
# =====================
MEDICINE_DB = {
    "λ‘ν†µ": {
        "μ•½": ["νƒ€μ΄λ λ†€", "κ²λ³΄λ¦°"],
        "μ§λ³‘": ["νΈλ‘ν†µ", "κΈ΄μ¥μ„± λ‘ν†µ"],
        "μ£Όμ μ²΄μ§": "κ°„ μ§ν™ ν™μλ” λ³µμ© μ „ μμ‚¬ μƒλ‹΄ ν•„μ”",
        "μ²λ°©μ „": False
    },
    "λ°μ—΄": {
        "μ•½": ["νƒ€μ΄λ λ†€", "μ΄λ¶€ν”„λ΅ν"],
        "μ§λ³‘": ["κ°κΈ°", "μΈν”λ£¨μ—”μ"],
        "μ£Όμ μ²΄μ§": "μ„μ¥ μ¥μ•  ν™μ μ£Όμ",
        "μ²λ°©μ „": False
    },
    "κΈ°μΉ¨": {
        "μ•½": ["μ½”λ°μΈ μ‹λ½", "λ±μ¤νΈλ΅λ©”ν† λ¥΄ν"],
        "μ§λ³‘": ["κΈ‰μ„± κΈ°κ΄€μ§€μ—Ό", "κ°κΈ°"],
        "μ£Όμ μ²΄μ§": "νΈν΅κΈ° μ§ν™μ μ£Όμ",
        "μ²λ°©μ „": True
    }
}

# =====================
# Streamlit μ•± κµ¬μ„±
# =====================

def main():
    # ----- νμ΄μ§€ μ„¤μ • -----
    st.set_page_config(page_title="μ•½ μ¶”μ² λ„μ°λ―Έ", page_icon="π’", layout="wide")

    # ----- ν—¤λ” -----
    st.title("π’ μ¦μƒ κΈ°λ° μ•½ μ¶”μ² λ„μ°λ―Έ")
    st.markdown("""
    ### π§Ύ μ‚¬μ© λ°©λ²•
    1. μ¦μƒμ„ μ…λ ¥ν•λ©΄ κ΄€λ ¨ **μ•½**, **κ°€λ¥ν• μ§λ³‘**, **μ²΄μ§ μ£Όμμ‚¬ν•­**μ„ λ³΄μ—¬λ“λ¦½λ‹λ‹¤.  
    2. μ•½μ΄ **μ²λ°©μ „ ν•„μ” μ—¬λ¶€**λ„ ν•¨κ» ν™•μΈν•  μ μμµλ‹λ‹¤.
    """)

    # ----- μ‚¬μ΄λ“λ°” -----
    st.sidebar.header("π” κ²€μƒ‰ μµμ…")
    symptom = st.sidebar.selectbox("μ¦μƒμ„ μ„ νƒν•μ„Έμ”:", list(MEDICINE_DB.keys()))

    # ----- λ©”μΈ κ²°κ³Ό -----
    if symptom:
        st.subheader(f"π©Ί '{symptom}' κ΄€λ ¨ μ •λ³΄")

        data = MEDICINE_DB[symptom]

        # μΉ΄λ“ ν•νƒ UI
        col1, col2, col3 = st.columns(3)

        with col1:
            st.metric(label="μ¶”μ² μ•½", value=", ".join(data["μ•½"]))

        with col2:
            st.metric(label="κ΄€λ ¨ μ§λ³‘", value=", ".join(data["μ§λ³‘"]))

        with col3:
            st.metric(label="μ²λ°©μ „ ν•„μ”", value="β… ν•„μ”" if data["μ²λ°©μ „"] else "β λ¶ν•„μ”")

        # μ£Όμμ‚¬ν•­ λ°•μ¤
        st.warning(f"β οΈ μ£Όμ μ²΄μ§: {data['μ£Όμ μ²΄μ§']}")

        # λ°μ΄ν„°ν”„λ μ„ μ‹κ°ν™”
        df = pd.DataFrame({
            "μ•½": data["μ•½"],
            "κ΄€λ ¨ μ§λ³‘": ", ".join(data["μ§λ³‘"]),
            "μ²λ°©μ „ ν•„μ” μ—¬λ¶€": ["μ" if data["μ²λ°©μ „"] else "μ•„λ‹μ¤"] * len(data["μ•½"])
        })

        st.dataframe(df, use_container_width=True)

        # μΈν„°λ™μ…: μ μ©μ„± ν”Όλ“λ°±
        feedback = st.radio("μ΄ μ •λ³΄κ°€ λ„μ›€μ΄ λμ—λ‚μ”?", ("λ„¤", "μ•„λ‹μ¤"))
        if feedback == "λ„¤":
            st.success("π λ„μ›€μ΄ λμ—λ‹¤λ‹ λ‹¤ν–‰μ…λ‹λ‹¤!")
        else:
            st.info("π’΅ λ” λ§μ€ λ°μ΄ν„°λ¥Ό μ¶”κ°€ν•κ² μµλ‹λ‹¤.")

    # ----- ν‘Έν„° -----
    st.markdown("---")
    st.caption("β€» λ³Έ μ„λΉ„μ¤λ” μ°Έκ³ μ©μ΄λ©°, μ‹¤μ  μ§„λ‹¨ λ° μ²λ°©μ€ μμ‚¬ μƒλ‹΄μ΄ ν•„μ”ν•©λ‹λ‹¤.")


# =====================
# μ‹¤ν–‰ μ‹μ‘
# =====================
if __name__ == "__main__":
    main()
